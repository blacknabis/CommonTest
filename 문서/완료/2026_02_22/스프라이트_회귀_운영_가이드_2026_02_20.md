# 스프라이트 회귀 운영 가이드
> 작성일: 2026-02-20  
> 대상: `AISpriteProcessor`, `GameScene` 누락 힌트 로그

## 1. 목적
- 스프라이트 처리/바인딩 관련 회귀를 에디터 메뉴로 빠르게 확인한다.
- 콘솔 로그 기준으로 정상/실패를 즉시 판별한다.

## 2. 실행 메뉴
1. `Tools/Common/AI Sprite Processor/Run Preset Load Regression`
2. `Tools/Kingdom/Sprites/Validate Runtime Sprite Bindings`
3. `Tools/Kingdom/Sprites/Run Missing Hint Regression`
4. `Tools/Kingdom/Sprites/Migrate Barracks Soldier Config References` (데이터 이관 시)

## 3. 실행 절차
### 3.1 Preset Load Regression
1. Unity Editor에서 메뉴 `Tools/Common/AI Sprite Processor/Run Preset Load Regression` 실행
2. Console에서 요약 로그 확인

### 3.2 Runtime Binding Validate
1. Unity Editor에서 메뉴 `Tools/Kingdom/Sprites/Validate Runtime Sprite Bindings` 실행
2. Console에서 `checked/resolved/missing` 요약 로그 확인
3. `missing > 0`이면 항목별 경고 로그 확인

### 3.3 Missing Hint Regression
1. Unity Editor에서 메뉴 `Tools/Kingdom/Sprites/Run Missing Hint Regression` 실행
2. Console에서 PASS/FAIL 로그 확인

### 3.4 Barracks 마이그레이션 (필요 시)
1. Unity Editor에서 메뉴 `Tools/Kingdom/Sprites/Migrate Barracks Soldier Config References` 실행
2. Console에서 `MigrationSummary tower=... created=... linked=... skipped=... failed=...` 확인

## 4. 기대 로그 스냅샷
### 4.1 Preset Load Regression 정상 예시
```text
[AISpriteProcessor] 프리셋 로드 상태 검증 통과. preset=...
[AISpriteProcessor] 프리셋 로드 회귀 검증 완료. 총 N개 / 통과 N / 실패 0
```

### 4.2 Preset Load Regression 실패 예시
```text
[AISpriteProcessor] 프리셋 로드 상태 검증 실패.
 - baseUnit.targetType expected=..., actual=...
 - baseUnit.actionGroup expected=..., actual=...
```

### 4.3 Missing Hint Regression 정상 예시
```text
[KingdomSpriteBindingTools] Missing hint regression passed. hints=5
```

### 4.4 Missing Hint Regression 실패 예시
```text
[KingdomSpriteBindingTools] Missing hint regression failed. missing=...
```

### 4.5 Runtime Binding Validate 정상 예시
```text
[KingdomSpriteBindingTools] Sprite binding validate done. checked=39, resolved=39, missing=0
```

### 4.6 Migration 정상 예시
```text
[AISpriteProcessor] MigrationSummary tower=5 created=1 linked=1 skipped=4 failed=0
```

## 5. 실패 시 확인 포인트
### 5.1 Preset Load Regression
1. 프리셋 JSON 누락/손상 여부 (`Assets/Editor/AISpritePresets/*.json`)
2. `schemaVersion`, `hasBindingContext` 값이 의도대로 저장됐는지
3. `BaseUnit` 탭의 `Target Type`, `Use Manual Action Group`, `Action Group`, `Auto Apply`가 로드 후 유지되는지
4. `TowerBase`의 `Level`, `Auto Apply`가 로드 후 유지되는지

### 5.2 Missing Hint Regression
1. `GameScene`의 `AppendMissingFixHintSummary` 메서드 시그니처 변경 여부
2. 힌트 키워드(예: `EnemyConfig.RuntimeSpriteResourcePath`, `TowerConfig.Levels[i].SpriteResourcePath`) 변경 여부
3. Console 경고/에러에서 누락 힌트 항목이 어떤 문구인지 확인

## 6. 운영 메모
- 현재 회귀 메뉴는 모달 다이얼로그를 사용하지 않으므로 자동 검증이 중단되지 않는다.
- 검증 성공/실패 판단 기준은 **Console 로그**가 기준이다.
