# Kingdom 작업 Task (정리본)

> 기준 문서: `문서/진행/월드맵_업그레이드_영웅관리소_플랜_2026_02_16.md`
> 마지막 갱신: 2026-02-16

## 운영 원칙
- [x] 완료된 상세 문서는 `문서/완료/2026_02_16`로 이관 완료
- [x] `task.md`는 현재 진행/다음 작업만 유지 (토큰 절감)

## 현재 메인 트랙: 월드맵 메타 UI

### Phase A. 월드맵 라우팅/모달 인프라
- [ ] `WorldMapView` 업그레이드 버튼 -> 실제 팝업 오픈 연결
- [ ] `WorldMapView` 영웅 관리소 버튼 -> 실제 팝업 오픈 연결
- [ ] 공통 오버레이 컨테이너(`OverlayContainer`) 구성
- [ ] 닫기 동선 통일(`X`, 배경 터치, BackKey)

### Phase B. UpgradesPopup 연결
- [ ] `UpgradesPopup.prefab` 생성
- [ ] `SkillTreeUI` 직렬화 바인딩 완료
- [ ] 6개 카테고리 탭 구성(아처/병영/메이지/포병/강화/유성)
- [ ] 별 부족 시 비활성/문구 처리 검증
- [ ] 구매 후 즉시 저장 및 UI 갱신 검증

### Phase C. HeroRoomPopup 연결
- [ ] `HeroRoomPopup.prefab` 생성
- [ ] `HeroSelectionUI` 직렬화 바인딩 완료
- [ ] 영웅 선택/파티 배치/해제 저장 연결
- [ ] 월드맵 재진입 시 선택 상태 복원 확인

### Phase D. 인게임 연동 최소 구현
- [ ] `SelectedHeroId` 기반 GameScene 영웅 로드 연결
- [ ] 업그레이드 수치의 전투 로직 반영 훅 연결(최소: 공격/사거리/쿨다운)
- [ ] 미적용 항목 경고 로그 정리(의도된 로그만 남김)

### Phase E. 검증
- [ ] 월드맵 -> 업그레이드 -> 월드맵 루프 정상
- [ ] 월드맵 -> 영웅관리소 -> 월드맵 루프 정상
- [ ] 앱 재실행 후 업그레이드/영웅 선택 데이터 유지
- [ ] 월드맵 -> 게임 진입 시 선택 영웅 반영
- [ ] 신규 콘솔 에러/치명 경고 0건

## 보류/후순위
- [ ] 업그레이드 Reset 기능
- [ ] 영웅 XP/레벨/스킬 포인트 시스템
- [ ] 영웅 장비 슬롯 시스템
- [ ] 난이도별 별 보상 정책 정교화(스테이지 제작 시점)

## 최근 완료(요약)
- [x] 게임씬 전투 루프(웨이브/스폰/경로/결과/저장) 기본 동작 확보
- [x] 타워 업그레이드/투사체/충돌 기반 데미지 반영
- [x] HeroPortraitWidget 분리 및 HUD 구조 안정화
- [x] Scene loop regression / Save compatibility self-test 통과 기록 확보
